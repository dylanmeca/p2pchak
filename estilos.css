/* estilos.css — NightOwl Premium (fusionado)
   - Paleta NightOwl pulida + design tokens
   - Superficies app-nativa (elevación, glass, blur)
   - Burbujas modernas con luz direccional y micro-interacciones
   - File-card con link descargable y thumbnail
   - Typing wave, streaming/text wrapping
   - Textarea (enter = newline, autosize friendly)
   - Responsive, accessibility, reduced-motion
*/

/* ===================== Design tokens (centralizados) ===================== */
:root{
  /* Background */
  --bg-0: #020617;
  --bg-1: #071226;
  --noise: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQI12O0dOnfPwAHUQK8lKJYyQAAAABJRU5ErkJggg==');

  /* Accent colors */
  --accent: #25d0b3;      /* primario (turquesa) */
  --accent-2: #8bd5ff;    /* secundario (azul claro) */
  --lavender: #7c5cff;

  /* Bubble gradients (legacy variables maintained) */
  --bubble-in-start: #08306f;
  --bubble-in-end: #0b5bb0;
  --bubble-out-start: #ffd7b3;
  --bubble-out-end: #ffb78a;

  --bubble-in-bg: linear-gradient(180deg, var(--bubble-in-start), var(--bubble-in-end));
  --bubble-out-bg: linear-gradient(180deg, var(--bubble-out-start), var(--bubble-out-end));

  --bubble-in-text: #eef7ff;
  --bubble-out-text: #1b2b28;

  /* Text */
  --text: #e6eef6;
  --text-muted: #94a3b8;
  --meta-color: #9bb0c8;

  /* Surfaces */
  --panel-glass: rgba(255,255,255,0.03);
  --surface-glass: rgba(255,255,255,0.02);
  --surface-strong: rgba(255,255,255,0.035);
  --glass-border: rgba(255,255,255,0.03);

  /* Radii / Elevation */
  --radius-xl: 18px;
  --radius-lg: 14px;
  --radius-md: 10px;
  --shadow-soft: 0 10px 40px rgba(0,0,0,0.6);
  --shadow-pop: 0 8px 26px rgba(2,8,20,0.6);
  --elev-1: 0 8px 30px rgba(2,9,20,0.6);
  --elev-2: 0 12px 44px rgba(2,9,20,0.65);

  /* Motion & misc */
  --focus: 0 0 0 4px rgba(37,208,179,0.12);
  --dur-short: 160ms;
  --dur-med: 260ms;
  --ease: cubic-bezier(.2,.9,.2,1);

  /* Layout */
  --max-width: 980px;
}

/* ===================== Base / Layout ===================== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  background:
    var(--noise),
    radial-gradient(900px 500px at 10% 6%, rgba(124,92,255,0.03), transparent 8%),
    linear-gradient(180deg, var(--bg-0), var(--bg-1) 1600px);
  background-blend-mode: overlay;
}

/* page wrapper */
.page{ max-width:var(--max-width); margin:28px auto; padding:18px; }

/* ===================== Header / App bar (native feeling) ===================== */
.app-bar, .top{
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:center;
  margin-bottom:0;
}

/* title row: title + favicon */
.title-row{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:14px;
  width:100%;
}
.site-title{
  margin:0;
  font-size:28px;
  font-weight:700;
  line-height:1;
  background: linear-gradient(90deg, var(--accent-2) 0%, #9ad8ff 40%, rgba(255,255,255,0.9) 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  letter-spacing:0.2px;
}
.site-favicon{
  height:1em; /* ties to title size */
  width:auto;
  display:inline-block;
  object-fit:contain;
  vertical-align:middle;
  border-radius:8px;
  box-shadow: 0 8px 26px rgba(0,0,0,0.45);
  border: 1px solid rgba(255,255,255,0.02);
}

/* site description wrapper */
.site-desc-wrapper{
  display:inline-block;
  text-align:left;
  margin:0 auto;
  max-width:720px;
  padding:18px;
  border-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: var(--elev-1);
}
.site-desc{ margin:0; color:var(--text-muted); font-size:14px; }

/* divider */
.divider{ border:0; height:1px; margin-top:12px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.02), transparent); width:100%; }

/* ===================== Chat card (main surface) ===================== */
.chat-wrapper{
  margin-top:12px;
  border-radius:var(--radius-lg);
  padding:14px;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.008));
  box-shadow: var(--shadow-soft);
  backdrop-filter: blur(8px) saturate(1.04);
  border:1px solid var(--glass-border);
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* ===================== Controls ===================== */
.controls{
  display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; width:100%;
}
.controls .left{ display:flex; align-items:center; gap:10px; font-weight:700; color:var(--text); }
#myId{ padding:8px 12px; background: rgba(255,255,255,0.01); border-radius:10px; font-weight:700; letter-spacing:1px; border:1px solid rgba(255,255,255,0.03); color:var(--accent-2); }

.controls .right{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.controls label{ color:var(--text-muted); font-weight:600; font-size:14px; }
.controls input{ padding:10px 12px; border-radius:10px; border: 1px solid rgba(255,255,255,0.04); background: rgba(255,255,255,0.012); color:var(--text); width:150px; font-weight:600; outline:none; transition:box-shadow var(--dur-short), transform var(--dur-short); }
.controls input:focus{ box-shadow: 0 6px 18px rgba(29,209,179,0.08); transform: translateY(-1px); }

/* buttons */
.btn{ padding:8px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:700; font-size:14px; transition: transform var(--dur-short), box-shadow var(--dur-short); }
.btn.primary{ background: linear-gradient(180deg,var(--accent), #10ad92); color:#021915; box-shadow: 0 10px 24px rgba(16,173,146,0.12); }
.btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.03); color:var(--text); }

/* clip icon (visible) */
.btn-icon{ background: transparent; border:0; padding:8px; border-radius:8px; cursor:pointer; color:var(--accent-2); display:inline-grid; place-items:center; transition: transform var(--dur-short), opacity var(--dur-short); }
.btn-icon:hover{ transform: translateY(-3px); opacity:0.95; }
.btn-icon svg{ width:22px; height:22px; }

/* ===================== Messages area ===================== */
.messages-area{
  background: linear-gradient(180deg, rgba(7,18,28,0.72), rgba(2,10,18,0.7));
  border-radius: calc(var(--radius-lg)-2px);
  padding:22px;
  position:relative;
  overflow:auto;
  min-height:520px;
  border:1px solid rgba(255,255,255,0.02);
  box-shadow:var(--shadow-pop);
}
.messages{ display:flex; flex-direction:column; gap:18px; width:100%; }

/* smooth scrollbar */
.messages-area{ scroll-behavior:smooth; }
.messages-area::-webkit-scrollbar{ width:10px; height:10px; }
.messages-area::-webkit-scrollbar-track{ background:transparent; }
.messages-area::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.05); border-radius:10px; border:2px solid transparent; background-clip: padding-box; }
.messages-area:hover::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.09); }

/* ===================== Message bubbles ===================== */
.message{
  max-width:76%;
  padding:14px 18px;
  border-radius:14px;
  font-size:15.5px;
  line-height:1.28;
  color:var(--text);
  position:relative;
  transition: transform var(--dur-short) var(--ease), box-shadow var(--dur-short) var(--ease), opacity var(--dur-short);
  word-break: break-word;
  display:inline-block;
}

/* incoming */
.message.in{
  align-self:flex-start;
  background: var(--bubble-in-bg);
  color: var(--bubble-in-text);
  border: 1px solid rgba(12,80,160,0.12);
  box-shadow: 0 8px 30px rgba(3,22,45,0.55), inset 0 1px 0 rgba(255,255,255,0.02);
  border-bottom-left-radius:6px;
}
.message.in:hover{ transform: translateY(-4px); box-shadow: 0 16px 44px rgba(3,22,45,0.65); }

/* outgoing */
.message.out{
  align-self:flex-end;
  background: var(--bubble-out-bg);
  color: var(--bubble-out-text);
  border: 1px solid rgba(255,200,160,0.08);
  box-shadow: 0 8px 30px rgba(12,8,8,0.38), inset 0 -1px 0 rgba(255,255,255,0.02);
  border-bottom-right-radius:6px;
}
.message.out:hover{ transform: translateY(-4px); box-shadow: 0 16px 44px rgba(12,8,8,0.45); }

/* sheen on outgoing */
.message.out::before{
  content:"";
  position:absolute;
  right:8px; top:0;
  height:40%;
  width:40%;
  background: linear-gradient(90deg, rgba(255,255,255,0.08), transparent 60%);
  border-radius:8px;
  pointer-events:none;
  transform: translateY(-8px) rotate(-6deg);
  mix-blend-mode: overlay;
  opacity:0.8;
}

/* stream text/wrapping */
.message .message-body,
.stream-text{
  white-space: pre-wrap;
  word-break: break-word;
  overflow-wrap: anywhere;
  color: inherit;
  font-size:15.5px;
  line-height:1.28;
}

/* timestamp / meta */
.message small{ display:block; color:var(--meta-color); font-size:12px; margin-top:8px; opacity:0.95; }

/* images within messages */
.message img{ display:block; border-radius:10px; max-width:420px; width:100%; height:auto; object-fit:cover; }

/* hover pop */
.message:hover{ transform: translateY(-4px); box-shadow: 0 14px 34px rgba(2,8,20,0.48); }

/* subtle tail */
.message.in::after,
.message.out::after{
  content:"";
  position:absolute; width:14px; height:14px; bottom:0;
  transform: translateY(50%) rotate(45deg); z-index:0;
  filter: blur(.2px);
}
.message.in::after{ left:-6px; background: rgba(255,255,255,0.02); }
.message.out::after{ right:-6px; background: rgba(255,255,255,0.02); }

/* ===================== File card (thumbnail + link) ===================== */
.file-card {
  display:flex;
  align-items:center;
  gap:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));
  border-radius:12px;
  padding:10px 12px;
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: 0 10px 30px rgba(0,0,0,0.55);
  max-width: 76%;
}
.file-card.in { align-self:flex-start; }
.file-card.out { align-self:flex-end; }

.file-card .file-icon{
  width:56px; height:56px; min-width:56px; border-radius:8px;
  display:grid; place-items:center;
  background: linear-gradient(180deg, rgba(11,102,195,0.14), rgba(11,102,195,0.06));
  border:1px solid rgba(255,255,255,0.02);
  color: var(--accent-2);
  font-weight:700;
}

.file-card .file-thumb{
  width:140px; height:88px; border-radius:8px; object-fit:cover; box-shadow:0 10px 26px rgba(0,0,0,0.45); flex-shrink:0; cursor:pointer;
}
.file-card .file-meta{ display:flex; flex-direction:column; gap:6px; min-width:0; }
.file-card .file-name{
  font-weight:700; color:inherit; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-decoration:none; display:inline-block; max-width:360px;
}
.file-card .file-name:hover,
.file-card .file-name:focus{
  text-decoration:underline; outline:none; box-shadow: 0 6px 18px rgba(29,209,179,0.07); border-radius:6px;
}
.file-card .file-size{ font-size:13px; color:var(--meta-color); }

/* download button */
.file-card .file-download{
  margin-left:auto;
  display:grid; place-items:center;
  width:46px; height:46px; border-radius:10px;
  background: linear-gradient(180deg,var(--accent), #10ad92);
  color:#02221a; box-shadow: 0 10px 26px rgba(16,173,146,0.12); border:none; cursor:pointer;
}
.file-card .file-download:active{ transform: translateY(2px) }

/* compatibility: message.file -> render card */
.message.file { padding:0; border-radius:12px; background:transparent; border:0; box-shadow:none; }
.message.file > * { margin:0; }
.message.file .file-card { margin:0; }

/* ===================== Typing indicator ===================== */
.typing{
  position:absolute;
  bottom:108px;
  left:36px;
  padding:8px 12px;
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  box-shadow: 0 8px 22px rgba(0,0,0,0.55);
}
.dots{ display:flex; gap:7px; align-items:center; justify-content:center; }
.dots span{ width:8px; height:8px; border-radius:50%; background: rgba(255,255,255,0.14); transform-origin:center; animation: wave 1s infinite ease-in-out; }
.dots span:nth-child(2){ animation-delay: .12s; } .dots span:nth-child(3){ animation-delay: .24s; }
@keyframes wave{
  0%{ transform: translateY(0) scale(1); opacity:.6 }
  30%{ transform: translateY(-6px) scale(1.15); opacity:1 }
  60%{ transform: translateY(0) scale(1); opacity:.75 }
  100%{ transform: translateY(0) scale(1); opacity:.6 }
}

/* ===================== Composer (input) ===================== */
.composer{
  display:flex; gap:12px; align-items:center; padding:12px;
  border-radius:16px;
  background: linear-gradient(90deg, rgba(255,255,255,0.008), rgba(255,255,255,0.006));
  border:1px solid rgba(255,255,255,0.02);
  box-shadow: var(--elev-1);
}
.message-input{
  flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.04);
  background: rgba(255,255,255,0.012); color:var(--text); font-size:15.5px; outline:none;
  transition: box-shadow var(--dur-short); resize:none; min-height:48px; max-height:40vh; overflow:auto; line-height:1.4;
}
.message-input:focus{ box-shadow: 0 8px 22px rgba(29,209,179,0.06); transform: translateY(-1px); }
.message-input::placeholder { color: rgba(255,255,255,0.28); }

/* send & icons */
.btn-send{ width:56px; height:56px; border-radius:12px; display:grid; place-items:center; cursor:pointer; background: linear-gradient(180deg,var(--accent), #10ad92); color:#02221a; box-shadow: 0 12px 26px rgba(16,173,146,0.12); transition: transform var(--dur-short) var(--ease), box-shadow var(--dur-short) var(--ease); }
.btn-send:active{ transform: translateY(2px) scale(.995) }

/* plane fly animation (JS can add .fly to icon) */
@keyframes fly-plane {
  0% { transform: translateY(0) scale(1) rotate(0); opacity:1; }
  60% { transform: translateY(-10px) translateX(20px) scale(.9) rotate(-6deg); opacity:0.9; }
  100% { transform: translateY(-40px) translateX(180px) scale(.4) rotate(-14deg); opacity:0; }
}

/* ===================== Micro-interactions, polish ===================== */
/* Vignette / subtle depth */
.page::before{
  content:"";
  position:fixed; inset:0; pointer-events:none;
  background: radial-gradient(60% 40% at 50% 40%, rgba(255,255,255,0.02), transparent 20%);
  mix-blend-mode: overlay; opacity:0.7;
}

/* glow on hover for main surfaces */
.chat-wrapper:hover,
.site-desc-wrapper:hover{
  box-shadow:
    0 18px 60px rgba(0,0,0,0.65),
    0 0 0 1px rgba(255,255,255,0.02),
    0 0 60px rgba(29,209,179,0.02);
}

/* status bar */
.status{
  margin-top:10px; padding:10px 14px; border-radius:12px; font-size:14px; font-weight:600; color:var(--text-muted);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.006));
  border:1px solid rgba(255,255,255,0.03); box-shadow: var(--elev-1);
}
.status span{ color:var(--accent); font-weight:700; }
.status.connected span{ color: var(--accent); }
.status.disconnected span{ color: #ff7b7b; }
.status.connecting span{ color: #ffd36a; }

/* message in entry animation */
@keyframes message-in{ from{ opacity:0; transform: translateY(14px) scale(.98); } to{ opacity:1; transform: translateY(0) scale(1); } }
.message{ animation: message-in 240ms var(--ease) both; }

/* links inside messages */
.message a{ color: inherit; font-weight:700; text-decoration:underline; text-decoration-color: rgba(255,255,255,0.35); text-underline-offset:3px; }
.message a:hover{ text-decoration-color: currentColor; }

/* selection */
::selection{ background: rgba(29,209,179,0.28); color:#001b16; }

/* focus visible */
:focus-visible{ outline:none; box-shadow: 0 0 0 4px rgba(29,209,179,0.18); border-radius:10px; }

/* reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
}

/* high contrast */
@media (prefers-contrast: more){
  .message.in, .message.out{ box-shadow:none; border-width:2px; }
  .chat-wrapper{ border-color: rgba(255,255,255,0.08); }
}

/* empty state */
.messages-empty{ display:flex; align-items:center; justify-content:center; height:100%; color:var(--text-muted); font-size:15px; text-align:center; opacity:0.75; }

/* footer spacing fix to ensure composer doesn't overlap messages */
.messages-area::after{ content:""; display:block; height:12px; }

/* ===================== Utilities & accessibility ===================== */
button:focus, input:focus, .message-input:focus, .btn-icon:focus { outline:none; box-shadow: var(--focus); border-color: rgba(37,208,179,0.12); }
.hidden{ display:none !important; }
.center{ display:flex; align-items:center; justify-content:center; }

/* ===================== Responsive ===================== */
@media (max-width:820px){
  :root{ --max-width:94vw; }
  .page{ padding:12px; }
  .site-title{ font-size:20px; }
  .title-row{ gap:10px; }
  .site-desc-wrapper{ padding:12px; max-width:94vw; }
  .controls{ flex-direction:column; align-items:flex-start; gap:10px; }
  .controls .right{ width:100%; display:flex; gap:8px; justify-content:space-between; }
  .messages-area{ min-height:60vh; padding:14px; }
  .message{ max-width:88%; font-size:15px; }
  .typing{ bottom:96px; left:18px; }
  .btn-send{ width:48px; height:48px; }
  .btn-icon{ width:40px; height:40px; }
  .file-card { max-width: 92%; padding:10px; gap:10px; }
  .file-card .file-icon{ width:48px; height:48px; min-width:48px; }
  .file-card .file-thumb{ max-width:160px; max-height:120px; }
}

/* ===================== End of estilos.css ===================== */
