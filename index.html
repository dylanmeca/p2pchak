<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>p2pchak - Chat P2P en l√≠nea sin registro</title>
  <meta name="description" content="p2pchak es un servicio de comunicaci√≥n privada que utiliza la tecnolog√≠a P2P, ofreciendo chats temporales en l√≠nea sin necesidad de registro.">
  <meta name="author" content="Dylan Meca">
  <meta name="google-site-verification" content="lBg4RSX2hnEcxA7fWW46cux1hJYk1zvuvF55FjpzZYk" />
  <meta name="msvalidate.01" content="4934D978F9E22D0A0239EA507C20F2CF" />
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#001224">
  <!-- Apple -->
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:locale" content="es_ES">
  <meta property="og:site_name" content="p2pchak - un chat p2p en l√≠nea">
  <meta property="og:title" content="p2pchak">
  <meta property="og:url" content="https://p2pchak.vercel.app/">
  <meta property="og:description" content="p2pchak es un servicio de comunicaci√≥n privada que utiliza la tecnolog√≠a P2P, ofreciendo chats temporales en l√≠nea sin necesidad de registro.">

  <!-- Twitter -->
  <meta name="twitter:site" content="@meca_dylan">
  <meta name="twitter:title" content="p2pchak - un chat p2p en l√≠nea">
  <meta name="twitter:description" content="p2pchak es un servicio de comunicaci√≥n privada que utiliza la tecnolog√≠a P2P, ofreciendo chats temporales en l√≠nea sin necesidad de registro.">
  <meta name="twitter:url" content="https://p2pchak.vercel.app/">
  <meta name="twitter:card" content="summary">

  <link rel="canonical" href="https://p2pchak.vercel.app/">

  <!-- Structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "p2pchak",
    "url": "https://p2pchak.vercel.app/",
    "description": "p2pchak es un servicio de comunicaci√≥n privada que utiliza la tecnolog√≠a P2P, ofreciendo chats temporales en l√≠nea sin necesidad de registro."
  }
  </script>

  <!-- Favicons (ico + png) -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" type="image/png">

  <!-- Minimal inline CSS para el encabezado (t√≠tulo + favicon visible y del mismo tama√±o) -->
  <style>
    /* Title row: centra t√≠tulo + favicon y los alinea */
    .title-row{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      flex-wrap:wrap;
    }
    .site-title{
      margin:0;
      font-size:28px; /* si cambias el tama√±o en estilos.css, el favicon tambi√©n crecer√° por usar 1em */
      font-weight:700;
      line-height:1;
      /* si usas background-clip text en estilos.css, mantenlo */
    }
    /* La imagen al lado del t√≠tulo ‚Äî altura igual al tama√±o de fuente del t√≠tulo */
    .site-favicon{
      height:1em;            /* iguala la altura a la del t√≠tulo (1em = font-size de .site-title) */
      width:auto;
      display:inline-block;
      object-fit:contain;
      vertical-align:middle;
      border-radius:6px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    }
    /* Ajuste responsivo: en pantallas peque√±as bajamos tama√±o del t√≠tulo y del favicon */
    @media (max-width:520px){
      .site-title{ font-size:20px; }
      .site-favicon{ height:1em; } /* 1em = 20px ahora */
    }
    /* Asegurar que el header interior tenga un poco de separaci√≥n */
    .top .meta-row{ margin-top:8px; display:flex; gap:8px; align-items:center; justify-content:center; flex-wrap:wrap; }

    /* site-desc-wrapper inline fallback (kept from original) */
    .site-desc-wrapper {
      display: inline-block;
      text-align: left;
      margin: 0 auto;
      max-width: 720px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 12px;
    }
    .site-desc-wrapper ol,
    .site-desc-wrapper ul { margin-left: 1.2em; padding-left: 0; }
    .site-desc-wrapper li { margin: 0.25em 0; }
    .site-desc-wrapper strong { display: block; margin-top: 0.6em; margin-bottom: 0.35em; }
  </style>

  <link rel="stylesheet" href="estilos.css">
  <!-- PeerJS CDN -->
  <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js" defer></script>
</head>
<body>
  <main class="page" role="main">
    <header class="top" role="banner">
      <div class="title-row" aria-hidden="false">
        <!-- T√≠tulo -->
        <h1 class="site-title">p2pchak</h1>

        <!-- favicon.png mostrado a la derecha del t√≠tulo y escalado al mismo tama√±o -->
        <img src="/favicon.png" alt="p2pchak logo" class="site-favicon" aria-hidden="false" />
      </div>

      <div class="site-desc-wrapper">
        <p class="site-desc">
          üü¢ Con√©ctate directamente con tus conocidos, comparte archivos o chatea, sin historial ni registros en servidores.
        </p>

        <strong class="site-desc">üîë C√≥mo conectarte:</strong>
        <ol class="site-desc">
          <li>Copia y comparte tu ID con la persona con la que deseas chatear.</li>
          <li>La otra persona introduce tu ID y ¬°conecta!</li>
        </ol>

        <strong class="site-desc">üîí Por qu√© elegir p2pchak:</strong>
        <ul class="site-desc">
          <li>Chats sin historial y temporales que se eliminan autom√°ticamente al cerrar la pesta√±a.</li>
          <li>Compartir archivos entre usuarios, gratis.</li>
          <li>Privacidad gracias a la tecnolog√≠a P2P.</li>
          <li>No requiere registro ni pasos adicionales.</li>
        </ul>
      </div>

      <div class="meta-row" aria-hidden="false">
        <a href="https://github.com/dylanmeca/p2pchak" target="_blank" rel="noopener noreferrer" aria-label="Repositorio en GitHub">
          <img src="https://img.shields.io/github/stars/dylanmeca/p2pchak?style=for-the-badge&labelColor=000000&color=555555&logoColor=white" alt="GitHub stars" style="cursor:pointer;">
        </a>
      </div>

      <hr class="divider" />
    </header>

    <section class="chat-wrapper" aria-live="polite">
      <section class="controls" role="region" aria-label="Controles de conexi√≥n">
        <div class="left" aria-hidden="false">
          Tu ID:
          <span id="myId" aria-label="Tu ID">‚Äî ‚Äî ‚Äî ‚Äî</span>

          <!-- Bot√≥n para copiar ID -->
          <button id="copyIdBtn" class="btn ghost" title="Copiar ID" aria-label="Copiar mi ID">Copiar</button>
        </div>

        <div class="right" role="form" aria-label="Conectar a par">
          <label for="peerIdInput">ID del par:</label>
          <input id="peerIdInput" placeholder="ej. A1B2C" inputmode="text" aria-label="ID del par" />
          <button id="connectBtn" class="btn primary" aria-label="Conectar">Conectar</button>
          <button id="disconnectBtn" class="btn ghost" hidden aria-label="Desconectar">Desconectar</button>
        </div>
      </section>

      <section id="messagesArea" class="messages-area" role="log" aria-live="polite" aria-relevant="additions">
        <div id="messages" class="messages"></div>

        <!-- typing indicator (hidden por defecto) -->
        <div id="typingIndicator" class="typing" hidden aria-hidden="true" aria-live="off">
          <div class="dots" aria-hidden="true">
            <span></span><span></span><span></span>
          </div>
        </div>
      </section>

      <section class="composer" role="region" aria-label="Escribir mensaje">
        <textarea id="messageInput" class="message-input" placeholder="Escribe un mensaje..." autocomplete="off" rows="2" aria-label="Escribe un mensaje"></textarea>
        <input id="fileInput" type="file" hidden aria-hidden="true" />

        <!-- Clip / Adjuntar (usa currentColor) -->
        <button id="attachBtn" class="btn-icon" title="Adjuntar archivo" aria-label="Adjuntar archivo">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="none" aria-hidden="true" focusable="false" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21.44 11.05L12.7 19.79a4.75 4.75 0 0 1-6.72 0 4.75 4.75 0 0 1 0-6.72L12 7.97"></path>
          </svg>
        </button>

        <!-- Enviar -->
        <button id="sendBtn" class="btn-send" title="Enviar mensaje" aria-label="Enviar mensaje">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="none" aria-hidden="true" focusable="false" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 2L11 13"></path>
            <path d="M22 2l-7 20 0-9-9-1 16-10z"></path>
          </svg>
        </button>
      </section>

      <div id="statusBar" class="status" role="status" aria-live="polite">Estado: <span id="statusText">Desconectado</span></div>
    </section>
  </main>

  <!-- Peque√±o script para copiar el ID (feedback) -->
  <script>
    (function(){
      const copyBtn = document.getElementById('copyIdBtn');
      const myIdEl = document.getElementById('myId');

      function flashText(el, text, ms = 1200){
        const prev = el.textContent;
        el.textContent = text;
        setTimeout(()=> { el.textContent = prev; }, ms);
      }

      copyBtn.addEventListener('click', async () => {
        const id = myIdEl.textContent.trim();
        if(!id || id === '‚Äî ‚Äî ‚Äî ‚Äî') {
          flashText(copyBtn, 'Sin ID');
          return;
        }
        try {
          await navigator.clipboard.writeText(id);
          flashText(copyBtn, 'Copiado');
        } catch (e) {
          try {
            const ta = document.createElement('textarea');
            ta.value = id; document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            flashText(copyBtn, 'Copiado');
          } catch (err) {
            flashText(copyBtn, 'Error');
          }
        }
      });
    })();
  </script>

  <!-- l√≥gica del chat -->
  <script src="chat.js" defer></script>

  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then(reg => {
          console.log('Service Worker registrado:', reg);
        }).catch(err => {
          console.warn('Service Worker fallo:', err);
        });
    });
  }
  </script>

</body>
</html>
